---
title: "Tensorflow 예제 1 연습!"
date: 2019-08-22 04:56:00 -0400
categories: tensorflow exercise 
---
드.디.어. 텐서플로우 예제를 돌려보았다.
참고한 링크는 https://pinkwink.kr/1080 이다.
텐서플로우를 사용하는 것에 의의를 두었기 때문에 train set과 test set을 구별하지 않은, 정말 기본적인 예제이다.
링크에 자세한 설명이 나와있지만, 생초보인 나는 나를 위한 설명을 해보겠다. 
저랑 비슷한 왕왕왕초보님덜 두눈뜨고 잘 따라오세유 노빠꾸예유~~

<h3>1. tensorflow랑 numpy 두 개 import하기 </h3>
<div class="colorscripter-code" style="color:#010101;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important; position:relative !important;overflow:auto"><table class="colorscripter-code-table" style="margin:0;padding:0;border:none;background-color:#fafafa;border-radius:4px;" cellspacing="0" cellpadding="0"><tr><td style="padding:6px;border-right:2px solid #e5e5e5"><div style="margin:0;padding:0;word-break:normal;text-align:right;color:#666;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important;line-height:130%"><div style="line-height:130%">1</div><div style="line-height:130%">2</div><div style="line-height:130%">3</div><div style="line-height:130%">4</div><div style="line-height:130%">5</div><div style="line-height:130%">6</div></div></td><td style="padding:6px 0;text-align:left"><div style="margin:0;padding:0;color:#010101;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important;line-height:130%"><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#a71d5d">import</span>&nbsp;tensorflow&nbsp;as&nbsp;tf</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#a71d5d">import</span>&nbsp;numpy&nbsp;as&nbsp;np</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">tf.set_random_seed(<span style="color:#0099cc">777</span>)</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#066de2">print</span>(tf.__version__)</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#066de2">print</span>(<span style="color:#63a35c">"Hello"</span>)</div></div></td><td style="vertical-align:bottom;padding:0 2px 4px 0"><a href="http://colorscripter.com/info#e" target="_blank" style="text-decoration:none;color:white"><span style="font-size:9px;word-break:normal;background-color:#e5e5e5;color:white;border-radius:10px;padding:1px">cs</span></a></td></tr></table></div>
tensorflow랑 numpy를 사용하기 위해 가져왔다. 
<strong>Numpy란?</strong> (C언어로 구현된) 파이썬 라이브러리로, Numerical Python의 줄임말이다. 즉, 벡터 및 행렬 연산 등 고성능의 수치계산을 위해 제작되었다. 근데 주로 array(행렬) 단위의 연산을 수행한다. 
Numpy를 사용하기 위해서는 import numpy를 써야한다. 근데 코드에서 편의를 위해 좀더 짧게 줄여서 쓰기 위해서 as np를 덧붙인다. 즉, numpy를 가져오는데 np라는 이름으로 가져온다는 것이다.
<strong>Numpy의 함수들</strong>에 대해서는 이번주 내로 정리해서 올릴 예정이다. <br>

과연 tf.set_random_seed(777)은 무엇을 의미하는 걸까.. 
seed는 난수값(랜덤값)이라고 한다. 이때 seed안에 일정한 숫자(이 경우 777)를 넣으면, 일정한 패턴의 숫자들만 계속 나온다고 한다. 
예를 들어 이 코드를 한번 돌리면 234, 341, 61, 234, ... 다시 한번 돌려도 234, 341, 61, 234, ... 이런 식으로. 
(보충설명이 필요하다)

tf의 버전을 확인하기 위해서 tf.__version__을 print해보았고, 1.14버전임을 알았다. 

<h3>2. 입출력데이터를 설정해주기 </h3>
<div class="colorscripter-code" style="color:#010101;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important; position:relative !important;overflow:auto"><table class="colorscripter-code-table" style="margin:0;padding:0;border:none;background-color:#fafafa;border-radius:4px;" cellspacing="0" cellpadding="0"><tr><td style="padding:6px;border-right:2px solid #e5e5e5"><div style="margin:0;padding:0;word-break:normal;text-align:right;color:#666;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important;line-height:130%"><div style="line-height:130%">1</div><div style="line-height:130%">2</div><div style="line-height:130%">3</div><div style="line-height:130%">4</div><div style="line-height:130%">5</div><div style="line-height:130%">6</div><div style="line-height:130%">7</div><div style="line-height:130%">8</div><div style="line-height:130%">9</div></div></td><td style="padding:6px 0;text-align:left"><div style="margin:0;padding:0;color:#010101;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important;line-height:130%"><div style="padding:0 6px; white-space:pre; line-height:130%">#&nbsp;And</div><div style="padding:0 6px; white-space:pre; line-height:130%">x_data&nbsp;=&nbsp;np.array([[0,&nbsp;0],&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0,&nbsp;1],</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1,&nbsp;0],&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1,&nbsp;1]],&nbsp;dtype=np.float32)</div><div style="padding:0 6px; white-space:pre; line-height:130%">y_data&nbsp;=&nbsp;np.array([[0],</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0],</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[0],</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[1]],&nbsp;dtype=np.float32)</div></div></td><td style="vertical-align:bottom;padding:0 2px 4px 0"><a href="http://colorscripter.com/info#e" target="_blank" style="text-decoration:none;color:white"><span style="font-size:9px;word-break:normal;background-color:#e5e5e5;color:white;border-radius:10px;padding:1px">cs</span></a></td></tr></table></div>
<h3>3. 입출력 placeholder 설정 </h3>
<div class="colorscripter-code" style="color:#010101;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important; position:relative !important;overflow:auto"><table class="colorscripter-code-table" style="margin:0;padding:0;border:none;background-color:#fafafa;border-radius:4px;" cellspacing="0" cellpadding="0"><tr><td style="padding:6px;border-right:2px solid #e5e5e5"><div style="margin:0;padding:0;word-break:normal;text-align:right;color:#666;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important;line-height:130%"><div style="line-height:130%">1</div><div style="line-height:130%">2</div></div></td><td style="padding:6px 0;text-align:left"><div style="margin:0;padding:0;color:#010101;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important;line-height:130%"><div style="padding:0 6px; white-space:pre; line-height:130%">X&nbsp;=&nbsp;tf.placeholder(tf.float32,&nbsp;[None,&nbsp;2],&nbsp;name='x-input')</div><div style="padding:0 6px; white-space:pre; line-height:130%">Y&nbsp;=&nbsp;tf.placeholder(tf.float32,&nbsp;[None,&nbsp;1],&nbsp;name='y-input')</div></div></td><td style="vertical-align:bottom;padding:0 2px 4px 0"><a href="http://colorscripter.com/info#e" target="_blank" style="text-decoration:none;color:white"><span style="font-size:9px;word-break:normal;background-color:#e5e5e5;color:white;border-radius:10px;padding:1px">cs</span></a></td></tr></table></div>
<h3>4. Parameter(변수) 설정 </h3>
<div class="colorscripter-code" style="color:#010101;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important; position:relative !important;overflow:auto"><table class="colorscripter-code-table" style="margin:0;padding:0;border:none;background-color:#fafafa;border-radius:4px;" cellspacing="0" cellpadding="0"><tr><td style="padding:6px;border-right:2px solid #e5e5e5"><div style="margin:0;padding:0;word-break:normal;text-align:right;color:#666;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important;line-height:130%"><div style="line-height:130%">1</div><div style="line-height:130%">2</div><div style="line-height:130%">3</div><div style="line-height:130%">4</div></div></td><td style="padding:6px 0;text-align:left"><div style="margin:0;padding:0;color:#010101;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important;line-height:130%"><div style="padding:0 6px; white-space:pre; line-height:130%">W&nbsp;=&nbsp;tf.Variable(tf.random_normal([2,&nbsp;1]),&nbsp;name='weight')</div><div style="padding:0 6px; white-space:pre; line-height:130%">b&nbsp;=&nbsp;tf.Variable(tf.random_normal([1]),&nbsp;name='bias')</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">hypothesis&nbsp;=&nbsp;tf.sigmoid(tf.matmul(X,&nbsp;W)&nbsp;+&nbsp;b)</div></div></td><td style="vertical-align:bottom;padding:0 2px 4px 0"><a href="http://colorscripter.com/info#e" target="_blank" style="text-decoration:none;color:white"><span style="font-size:9px;word-break:normal;background-color:#e5e5e5;color:white;border-radius:10px;padding:1px">cs</span></a></td></tr></table></div>
<h3>5. cost/loss function 설정</h3>
<div class="colorscripter-code" style="color:#010101;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important; position:relative !important;overflow:auto"><table class="colorscripter-code-table" style="margin:0;padding:0;border:none;background-color:#fafafa;border-radius:4px;" cellspacing="0" cellpadding="0"><tr><td style="padding:6px;border-right:2px solid #e5e5e5"><div style="margin:0;padding:0;word-break:normal;text-align:right;color:#666;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important;line-height:130%"><div style="line-height:130%">1</div><div style="line-height:130%">2</div><div style="line-height:130%">3</div></div></td><td style="padding:6px 0;text-align:left"><div style="margin:0;padding:0;color:#010101;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important;line-height:130%"><div style="padding:0 6px; white-space:pre; line-height:130%">#&nbsp;cost/loss&nbsp;function&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">cost&nbsp;=&nbsp;-tf.reduce_mean(Y&nbsp;*&nbsp;tf.log(hypothesis)&nbsp;+&nbsp;(1&nbsp;-&nbsp;Y)&nbsp;*&nbsp;tf.log(1&nbsp;-&nbsp;hypothesis))</div><div style="padding:0 6px; white-space:pre; line-height:130%">train&nbsp;=&nbsp;tf.train.GradientDescentOptimizer(learning_rate&nbsp;=&nbsp;0.1).minimize(cost)</div></div></td><td style="vertical-align:bottom;padding:0 2px 4px 0"><a href="http://colorscripter.com/info#e" target="_blank" style="text-decoration:none;color:white"><span style="font-size:9px;word-break:normal;background-color:#e5e5e5;color:white;border-radius:10px;padding:1px">cs</span></a></td></tr></table></div>
<h3>6. 정확도 함수 설정 </h3>
<div class="colorscripter-code" style="color:#010101;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important; position:relative !important;overflow:auto"><table class="colorscripter-code-table" style="margin:0;padding:0;border:none;background-color:#fafafa;border-radius:4px;" cellspacing="0" cellpadding="0"><tr><td style="padding:6px;border-right:2px solid #e5e5e5"><div style="margin:0;padding:0;word-break:normal;text-align:right;color:#666;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important;line-height:130%"><div style="line-height:130%">1</div><div style="line-height:130%">2</div><div style="line-height:130%">3</div><div style="line-height:130%">4</div></div></td><td style="padding:6px 0;text-align:left"><div style="margin:0;padding:0;color:#010101;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important;line-height:130%"><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Accuracy&nbsp;computation</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;True&nbsp;if&nbsp;hypothesis&nbsp;&gt;&nbsp;0.5&nbsp;else&nbsp;False&nbsp;</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">predicted&nbsp;<span style="color:#0086b3"></span><span style="color:#a71d5d">=</span>&nbsp;tf.cast(hypothesis&nbsp;<span style="color:#0086b3"></span><span style="color:#a71d5d">&gt;</span>&nbsp;<span style="color:#0099cc">0.</span><span style="color:#0099cc">5</span>,&nbsp;dtype&nbsp;<span style="color:#0086b3"></span><span style="color:#a71d5d">=</span>&nbsp;tf.float32)</div><div style="padding:0 6px; white-space:pre; line-height:130%">accuracy&nbsp;<span style="color:#0086b3"></span><span style="color:#a71d5d">=</span>&nbsp;tf.reduce_mean(tf.cast(tf.equal(predicted,&nbsp;Y),&nbsp;dtype&nbsp;<span style="color:#0086b3"></span><span style="color:#a71d5d">=</span>&nbsp;tf.float32))</div></div></td><td style="vertical-align:bottom;padding:0 2px 4px 0"><a href="http://colorscripter.com/info#e" target="_blank" style="text-decoration:none;color:white"><span style="font-size:9px;word-break:normal;background-color:#e5e5e5;color:white;border-radius:10px;padding:1px">cs</span></a></td></tr></table></div>
<h3>7. 그래프 그리기 </h3>
<div class="colorscripter-code" style="color:#010101;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important; position:relative !important;overflow:auto"><table class="colorscripter-code-table" style="margin:0;padding:0;border:none;background-color:#fafafa;border-radius:4px;" cellspacing="0" cellpadding="0"><tr><td style="padding:6px;border-right:2px solid #e5e5e5"><div style="margin:0;padding:0;word-break:normal;text-align:right;color:#666;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important;line-height:130%"><div style="line-height:130%">1</div><div style="line-height:130%">2</div><div style="line-height:130%">3</div><div style="line-height:130%">4</div><div style="line-height:130%">5</div><div style="line-height:130%">6</div><div style="line-height:130%">7</div><div style="line-height:130%">8</div><div style="line-height:130%">9</div><div style="line-height:130%">10</div><div style="line-height:130%">11</div><div style="line-height:130%">12</div><div style="line-height:130%">13</div><div style="line-height:130%">14</div></div></td><td style="padding:6px 0;text-align:left"><div style="margin:0;padding:0;color:#010101;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important;line-height:130%"><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#&nbsp;Launch&nbsp;graph</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">with&nbsp;tf.Session()&nbsp;as&nbsp;sess:</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#999999">#Initialize&nbsp;TensorFlow&nbsp;variables</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;sess.run(tf.global_variables_initializer())</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a71d5d">for</span>&nbsp;step&nbsp;<span style="color:#a71d5d">in</span>&nbsp;<span style="color:#066de2">range</span>(<span style="color:#0099cc">10001</span>):</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sess.run(train,&nbsp;feed_dict&nbsp;<span style="color:#0086b3"></span><span style="color:#a71d5d">=</span>&nbsp;{X:&nbsp;x_data,&nbsp;Y:&nbsp;y_data})</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a71d5d">if</span>&nbsp;step&nbsp;%&nbsp;<span style="color:#0099cc">100</span>&nbsp;<span style="color:#0086b3"></span><span style="color:#a71d5d">=</span><span style="color:#0086b3"></span><span style="color:#a71d5d">=</span>&nbsp;<span style="color:#0099cc">0</span>:</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#066de2">print</span>(step,&nbsp;sess.run(cost,&nbsp;feed_dict&nbsp;<span style="color:#0086b3"></span><span style="color:#a71d5d">=</span>&nbsp;{X:&nbsp;x_data,&nbsp;Y:&nbsp;y_data}),&nbsp;sess.run(W))</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#999999">#Accuracy&nbsp;report&nbsp;</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;h,&nbsp;c,&nbsp;a&nbsp;<span style="color:#0086b3"></span><span style="color:#a71d5d">=</span>&nbsp;sess.run([hypothesis,&nbsp;predicted,&nbsp;accuracy],&nbsp;feed_dict&nbsp;<span style="color:#0086b3"></span><span style="color:#a71d5d">=</span>&nbsp;{X:&nbsp;x_data,&nbsp;Y:&nbsp;y_data})</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#066de2">print</span>(<span style="color:#63a35c">"\nHypothesis:&nbsp;"</span>,&nbsp;h,&nbsp;<span style="color:#63a35c">"\nCorrect:&nbsp;"</span>,&nbsp;c,&nbsp;<span style="color:#63a35c">"\Accuracy:&nbsp;"</span>,&nbsp;a)</div></div></td><td style="vertical-align:bottom;padding:0 2px 4px 0"><a href="http://colorscripter.com/info#e" target="_blank" style="text-decoration:none;color:white"><span style="font-size:9px;word-break:normal;background-color:#e5e5e5;color:white;border-radius:10px;padding:1px">cs</span></a></td></tr></table></div>


